verbose = 0

#
z_number = {}
z_number['H']	=   1000
z_number['He']	=   2000
z_number['Li']	=   3000
z_number['Be']	=   4000
z_number['B']	=   5000
z_number['C']	=   6000
z_number['N']	=   7000
z_number['O']	=   8000
z_number['F']	=   9000
z_number['Ne']	=  10000 	
z_number['Na']	=  11000 	
z_number['Mg']	=  12000 	
z_number['Al']	=  13000 	
z_number['Si']	=  14000 	
z_number['P']	=  15000 	
z_number['S']	=  16000 	
z_number['Cl']	=  17000 	
z_number['Ar']	=  18000 	
z_number['K']	=  19000 	
z_number['Ca']	=  20000 	
z_number['Sc']	=  21000 	
z_number['Ti']	=  22000 	
z_number['V']	=  23000 	
z_number['Cr']	=  24000 	
z_number['Mn']	=  25000 	
z_number['Fe']	=  26000 	
z_number['Co']	=  27000 	
z_number['Ni']	=  28000 	
z_number['Cu']	=  29000 	
z_number['Zn']	=  30000 	
z_number['Ga']	=  31000 	
z_number['Ge']	=  32000 	
z_number['As']	=  33000 	
z_number['Se']	=  34000 	
z_number['Br']	=  35000 	
z_number['Kr']	=  36000 	
z_number['Rb']	=  37000 	
z_number['Sr']	=  38000 	
z_number['Y']	=  39000 	
z_number['Zr']	=  40000 	
z_number['Nb']	=  41000 	
z_number['Mo']	=  42000 	
z_number['Tc']	=  43000 	
z_number['Ru']	=  44000 	
z_number['Rh']	=  45000 	
z_number['Pd']	=  46000 	
z_number['Ag']	=  47000 	
z_number['Cd']	=  48000 	
z_number['In']	=  49000 	
z_number['Sn']	=  50000 	
z_number['Sb']	=  51000 	
z_number['Te']	=  52000 	
z_number['I']	=  53000 	
z_number['Xe']	=  54000 	
z_number['Cs']	=  55000 	
z_number['Ba']	=  56000 	
z_number['La']	=  57000 	
z_number['Ce']	=  58000 	
z_number['Pr']	=  59000 	
z_number['Nd']	=  60000 	
z_number['Pm']	=  61000 	
z_number['Sm']	=  62000 	
z_number['Eu']	=  63000 	
z_number['Gd']	=  64000 	
z_number['Tb']	=  65000 	
z_number['Dy']	=  66000 	
z_number['Ho']	=  67000 	
z_number['Er']	=  68000 	
z_number['Tm']	=  69000 	
z_number['Yb']	=  70000 	
z_number['Lu']	=  71000 	
z_number['Hf']	=  72000 	
z_number['Ta']	=  73000 	
z_number['W']	=  74000 	
z_number['Re']	=  75000 	
z_number['Os']	=  76000 	
z_number['Ir']	=  77000 	
z_number['Pt']	=  78000 	
z_number['Au']	=  79000 	
z_number['Hg']	=  80000 	
z_number['Tl']	=  81000 	
z_number['Pb']	=  82000 	
z_number['Bi']	=  83000 	
z_number['Po']	=  84000 	
z_number['At']	=  85000 	
z_number['Rn']	=  86000 	
z_number['Fr']	=  87000 	
z_number['Ra']	=  88000 	
z_number['Ac']	=  89000 	
z_number['Th']	=  90000 	
z_number['Pa']	=  91000 	
z_number['U']	=  92000 	
z_number['Np']	=  93000 	
z_number['Pu']	=  94000 	
z_number['Am']	=  95000 	
z_number['Cm']	=  96000 	
z_number['Bk']	=  97000 	
z_number['Cf']	=  98000 	
z_number['Es']	=  99000 	
z_number['Fm']	= 100000
z_number['Md']	= 101000
z_number['No']	= 102000
z_number['Lr']	= 103000
z_number['Rf']	= 104000
z_number['Db']	= 105000
z_number['Sg']	= 106000
z_number['Bh']	= 107000
z_number['Hs']	= 108000
z_number['Mt']	= 109000
z_number['Ds']	= 110000
z_number['Rg']	= 111000
z_number['Uub']	= 112000
z_number['Uut']	= 113000
z_number['Uuq']	= 114000
z_number['Uup']	= 115000
z_number['Uuh']	= 116000
z_number['Uus']	= 117000
z_number['Uuo']	= 118000

# From
# https://www.ncsu.edu/chemistry/msf/pdf/IsotopicMass_NaturalAbundance.pdf
amu = {}
amu[ 1001]= 1.007825032239
amu[ 1002]= 2.014101778121
amu[ 2003]= 3.016029
amu[ 2004]= 4.002603
amu[ 3006]= 6.015122
amu[ 3007]= 7.016004
amu[ 4009]= 9.012182
amu[ 5010]=10.012937
amu[ 5011]=11.009305
amu[ 6012]=12.000000
amu[ 6013]=13.003355
amu[ 7014]=14.003074
amu[ 7015]=15.000109
amu[ 8016]=15.994915
amu[ 8017]=16.999132
amu[ 8018]=17.999160
amu[ 9019]=18.998403
amu[10020]=19.992440
amu[10021]=20.993847
amu[10022]=21.991386
amu[11023]=22.989770
amu[12024]=23.985042
amu[12025]=24.985837
amu[12026]=25.982593
amu[13027]=26.981538
amu[14028]=27.976927
amu[14029]=28.976495
amu[14030]=29.973770
amu[15031]=30.973762
amu[16032]=31.972071
amu[16033]=32.971458
amu[16034]=33.967867
amu[16036]=35.967081
amu[17035]=34.968853
amu[17037]=36.965903
amu[18036]=35.967546
amu[18038]=37.962732
amu[18040]=39.962383
amu[19039]=38.963707
amu[19040]=39.963999
amu[19041]=40.961826
amu[20040]=39.962591
amu[20042]=41.958618
amu[20043]=42.958767
amu[20044]=43.955481
amu[20046]=45.953693
amu[20048]=47.952534
amu[21045]=44.955910
amu[22046]=45.952629
amu[22047]=46.951764
amu[22048]=47.947947
amu[22049]=48.947871
amu[22050]=49.944792
amu[23050]=49.947163
amu[23051]=50.943964
amu[24050]=49.946050
amu[24052]=51.940512
amu[24053]=52.940654
amu[24054]=53.938885
amu[25055]=54.938050
amu[26054]=53.939615
amu[26056]=55.934942
amu[26057]=56.935399
amu[26058]=57.933280
amu[27059]=58.933200
amu[28058]=57.935348
amu[28060]=59.930791
amu[28061]=60.931060
amu[28062]=61.928349
amu[28064]=63.927970
amu[29063]=62.929601
amu[29065]=64.927794
amu[30064]=63.929147
amu[30066]=65.926037
amu[30067]=66.927131
amu[30068]=67.924848
amu[30070]=69.925325
amu[31069]=68.925581
amu[31071]=70.924705
amu[32070]=69.924250
amu[32072]=71.922076
amu[32073]=72.923459
amu[32074]=73.921178
amu[32076]=75.921403
amu[33075]=74.921596
amu[34074]=73.922477
amu[34076]=75.919214
amu[34077]=76.919915
amu[34078]=77.917310
amu[34080]=79.916522
amu[34082]=81.916700
amu[35079]=78.918338
amu[35081]=80.916291
amu[36078]=77.920386
amu[36080]=79.916378
amu[36082]=81.913485
amu[36083]=82.914136
amu[36084]=83.911507
amu[36086]=85.910610
amu[37085]=84.911789
amu[37087]=86.909183
amu[38084]=83.913425
amu[38086]=85.909262
amu[38087]=86.908879
amu[38088]=87.905614
amu[39089]=88.905848
amu[40090]=89.904704
amu[40091]=90.905645
amu[40092]=91.905040
amu[40094]=93.906316
amu[40096]=95.908276
amu[41093]=92.906378
amu[42092]=91.906810
amu[42094]=93.905088
amu[42095]=94.905841
amu[42096]=95.904679
amu[42097]=96.906021
amu[42098]=97.905408
amu[42100]=99.907477
amu[43098]=97.907216
amu[44096]=95.907598
amu[44098]=97.905287
amu[44099]=98.905939
amu[44100]=99.904220
amu[44101]=100.905582
amu[44102]=101.904350
amu[44104]=103.905430
amu[45103]=102.905504
amu[46102]=101.905608
amu[46104]=103.904035
amu[46105]=104.905084
amu[46106]=105.903483
amu[46108]=107.903894
amu[46110]=109.905152
amu[47107]=106.905093
amu[47109]=108.904756
amu[48106]=105.906458
amu[48108]=107.904183
amu[48110]=109.903006
amu[48111]=110.904182
amu[48112]=111.902757
amu[48113]=112.904401
amu[48114]=113.903358
amu[48116]=115.904755
amu[49113]=112.904061
amu[49115]=114.903878
amu[50112]=111.904821
amu[50114]=113.902782
amu[50115]=114.903346
amu[50116]=115.901744
amu[50117]=116.902954
amu[50118]=117.901606
amu[50119]=118.903309
amu[50120]=119.902197
amu[50122]=121.903440
amu[50124]=123.905275
amu[51121]=120.903818
amu[51123]=122.904216
amu[52120]=119.904020
amu[52122]=121.903047
amu[52123]=122.904273
amu[52124]=123.902819
amu[52125]=124.904425
amu[52126]=125.903306
amu[52128]=127.904461
amu[52130]=129.906223
amu[53127]=126.904468
amu[54124]=123.905896
amu[54126]=125.904269
amu[54128]=127.903530
amu[54129]=128.904779
amu[54130]=129.903508
amu[54131]=130.905082
amu[54132]=131.904154
amu[54134]=133.905395
amu[54136]=135.907220
amu[55133]=132.905447
amu[56130]=129.906310
amu[56132]=131.905056
amu[56134]=133.904503
amu[56135]=134.905683
amu[56136]=135.904570
amu[56137]=136.905821
amu[56138]=137.905241
amu[57138]=137.907107
amu[57139]=138.906348
amu[58136]=135.907144
amu[58138]=137.905986
amu[58140]=139.905434
amu[58142]=141.909240
amu[59141]=140.907648
amu[60142]=141.907719
amu[60143]=142.909810
amu[60144]=143.910083
amu[60145]=144.912569
amu[60146]=145.913112
amu[60148]=147.916889
amu[60150]=149.920887
amu[61145]=144.912744
amu[62144]=143.911995
amu[62147]=146.914893
amu[62148]=147.914818
amu[62149]=148.917180
amu[62150]=149.917271
amu[62152]=151.919728
amu[62154]=153.922205
amu[63151]=150.919846
amu[63153]=152.921226
amu[64152]=151.919788
amu[64154]=153.920862
amu[64155]=154.922619
amu[64156]=155.922120
amu[64157]=156.923957
amu[64158]=157.924101
amu[64160]=159.927051
amu[65159]=158.925343
amu[66156]=155.924278
amu[66158]=157.924405
amu[66160]=159.925194
amu[66161]=160.926930
amu[66162]=161.926795
amu[66163]=162.928728
amu[66164]=163.929171
amu[67165]=164.930319
amu[68162]=161.928775
amu[68164]=163.929197
amu[68166]=165.930290
amu[68167]=166.932045
amu[68168]=167.932368
amu[68170]=169.935460
amu[69169]=168.934211
amu[70168]=167.933894
amu[70170]=169.934759
amu[70171]=170.936322
amu[70172]=171.936378
amu[70173]=172.938207
amu[70174]=173.938858
amu[70176]=175.942568
amu[71175]=174.940768
amu[71176]=175.942682
amu[72174]=173.940040
amu[72176]=175.941402
amu[72177]=176.943220
amu[72178]=177.943698
amu[72179]=178.945815
amu[72180]=179.946549
amu[73180]=179.947466
amu[73181]=180.947996
amu[74180]=179.946706
amu[74182]=181.948206
amu[74183]=182.950224
amu[74184]=183.950933
amu[74186]=185.954362
amu[75185]=184.952956
amu[75187]=186.955751
amu[76184]=183.952491
amu[76186]=185.953838
amu[76187]=186.955748
amu[76188]=187.955836
amu[76189]=188.958145
amu[76190]=189.958445
amu[76192]=191.961479
amu[77191]=190.960591
amu[77193]=192.962924
amu[78190]=189.959930
amu[78192]=191.961035
amu[78194]=193.962664
amu[78195]=194.964774
amu[78196]=195.964935
amu[78198]=197.967876
amu[79197]=196.966552
amu[80196]=195.965815
amu[80198]=197.966752
amu[80199]=198.968262
amu[80200]=199.968309
amu[80201]=200.970285
amu[80202]=201.970626
amu[80204]=203.973476
amu[81203]=202.972329
amu[81205]=204.974412
amu[82204]=203.973029
amu[82206]=205.974449
amu[82207]=206.975881
amu[82208]=207.976636
amu[83209]=208.980383
amu[90232]=232.038050
amu[91232]=231.035879
amu[92234]=234.040946
amu[92235]=235.043923
amu[92238]=238.050783



class mixture(object):

	_mixtures = {}

	def __new__(cls,name):
		if not isinstance(name,int):
			if isinstance(name,str):
				name = name.strip()
		else:
			print "name must be a string.  rejected."
			return None
		# else return a new instance
		return super(mixture,cls).__new__(cls)

	def __init__(self,name):
		import copy
		if isinstance(name,str):
			name = name.strip()
			self.name		= copy.deepcopy(name)
		else:
			print "name must be a string.  rejected."
			return None
		self.mode				= 'none'
		self.avg_amu			= 0.0
		self.mass_density		= 0.0
		self.mixtures_list		= []
		self.atom_fractions		= {}
		self.mass_fractions		= {}
		self.volume_fractions	= {}

	def add_mixture(self,name,frac,mode='mass'):
		if not isinstance(name,str):
			print "first input (name) is not a string.  rejected."
			return
		if not name in mixture._mixtures.keys():
			print "'"+name+"' not found in mixtures dictionary.  rejected."
			return
		if not isinstance(frac,float):
			print "second input is not a float atomic fraction.  rejected."
			return
		if not isinstance(mode,str):
			print "mode keyword input is not a string.  rejected."
			return
		if self.mode not in [mode,'none']:
			if verbose: print "element object is in %s mode.  delete and start over."%self.mode
		#
		self.mode = mode
		if mode == 'atom':
			self.mixtures_list.append([mixture._mixtures[name],frac,0.,0.])
		elif mode == 'mass':
			self.mixtures_list.append([mixture._mixtures[name],0.,frac,0.])
		elif mode == 'volume':
			self.mixtures_list.append([mixture._mixtures[name],0.,0.,frac])
		if verbose: print "added mixture %6d with amu %12.8f and %s fraction %15.8f into mixture %6d"%(name,_mixtures[name].avg_amu,self.mode,frac,self.name)

	def delete(self):
		element._elements.pop(self.name, None)
		self.__init__(self.name)
		if verbose: print "removed element %s from the class dictionary and re-initialized all data.  the instance has not necessarily been deleted from the python namespace yet!"%self.name

	def finalize(self):
		import numpy

		if self.mode == 'atom':
			# check that there is a mass density present (mass densities of input mixtures is not used)
			if self.mass_density==0.0:
				print "mass density needs to be input to finalize, aborting."
				return
			# check that there is a nonzero list of mixtures
			if len(self.mixtures_list)==0:
				print "no mixtures in list while in %s mode, aborting."%self.mode
				return
			#
			# MIXTURES
			#
			# sum the fractions, renormalize
			frac_total = 0.0
			for i in range(0,len(self.mixtures_list)):
				frac_total = frac_total + self.mixtures_list[i][1]
			for i in range(0,len(self.mixtures_list)):
				self.mixtures_list[i][1] = self.mixtures_list[i][1] / frac_total
			# calculate the mass and volume fractions of the individual mixtures
			mix_avg_amu = 0.0 
			for i in range(0,len(self.mixtures_list)):
				mix_avg_amu = mix_avg_amu + self.mixtures_list[i][0].avg_amu * self.mixtures_list[i][1]
			# calculate the mixture mass factions
			for i in range(0,len(self.mixtures_list)):
				self.mixtures_list[i][2] = self.mixtures_list[i][0].avg_amu * self.mixtures_list[i][1] / mix_avg_amu
			# calculate the mixture volume factions
			for i in range(0,len(self.mixtures_list)):
				self.mixtures_list[i][3] = 0.0
			#
			# SUMMED ISOTOPE LIST
			#
			# calculate the list of isotope atom fractions from the sum of the mixtures
			for i in range(0,len(self.mixtures_list)):
				for isotope in self.mixtures_list[i][0].atom_fractions.keys():
					if isotope in self.atom_fractions.keys():
						self.atom_fractions[isotope] = self.atom_fractions[isotope] + self.mixtures_list[i][0].atom_fractions[isotope] * self.mixtures_list[i][1]
					else:
						self.atom_fractions[isotope] =                                self.mixtures_list[i][0].atom_fractions[isotope] * self.mixtures_list[i][1]
			# calculate averge amu from the atom fractions
			self.avg_amu = 0.0 
			for isotope in self.atom_fractions.keys():
				self.avg_amu = self.avg_amu + amu[isotope] * self.atom_fractions[isotope]
			# calculate the mass factions
			for isotope in self.atom_fractions.keys():
				self.mass_fractions[isotope] = amu[isotope] * self.atom_fractions[isotope] / self.avg_amu

#		elif self.mode == 'mass':
#			# check that there is a nonzero list of mixtures
#			if len(self.mixtures_list)==0:
#				if verbose: print "no mixtures in list while in %s mode, aborting."%self.mode
#				return
#			# sum the fractions, renormalize
#			frac_total = 0.0
#			for isotope in self.mass_fractions.keys():
#				frac_total = frac_total + self.mass_fractions[isotope][1]
#			for isotope in self.mass_fractions.keys():
#				self.mass_fractions[isotope] = [self.mass_fractions[isotope][0] , self.mass_fractions[isotope][1] / frac_total]
#			# calculate averge amu from mass fractions
#			self.avg_amu = 0.0 
#			for isotope in self.atom_fractions.keys():
#				self.avg_amu = self.avg_amu + self.mass_fractions[isotope][1]/self.mass_fractions[isotope][0]
#			self.avg_amu = 1.0 / self.avg_amu
#			# calculate the atom factions
#			for isotope in self.mass_fractions.keys():
#				atom_frac = self.avg_amu * self.mass_fractions[isotope][1] / self.mass_fractions[isotope][0]
#				self.atom_fractions[isotope] = [self.mass_fractions[isotope][0] , atom_frac]
#
#		elif self.mode == 'volume':
#			# a density must NOT be set, since it will be overwritten, reject to avoid silent errors or unepected behavior
#			# must check that every input mixture has densities set
#			# check that there is a nonzero list of mixtures
#			if len(self.mixtures_list)==0:
#				if verbose: print "no mixtures in list while in %s mode, aborting."%self.mode
#				return
			

		elif self.mode == 'none':
			# check that there is a mass density present
			if self.mass_density==0.0:
				print "mass density needs to be input to finalize, aborting."
				return
			# check that there is a zero list of mixtures
			if len(self.mixtures_list)!=0:
				print "mixtures present in list while in %s mode, aborting."%self.mode
				return
			# check that only atom fractions exist (mass not supported as of yet...)
			if len(self.mass_fractions)>0:
				print "mass fractions present while in %s mode, aborting."%self.mode
				return
			if len(self.atom_fractions)<=0:
				print "no atom fraction present while in %s mode, aborting."%self.mode
				return
			# sum the fractions, renormalize
			frac_total = 0.0
			for isotope in self.atom_fractions.keys():
				frac_total = frac_total + self.atom_fractions[isotope]
			for isotope in self.atom_fractions.keys():
				self.atom_fractions[isotope] = self.atom_fractions[isotope] / frac_total
			# calculate averge amu from the atom fractions
			self.avg_amu = 0.0 
			for isotope in self.atom_fractions.keys():
				self.avg_amu = self.avg_amu + amu[isotope] * self.atom_fractions[isotope]
			# calculate the mass factions
			for isotope in self.atom_fractions.keys():
				self.mass_fractions[isotope] = amu[isotope] * self.atom_fractions[isotope] / self.avg_amu

		elif self.mode == 'finalized':
			print "already finalized."
			return
		else:
			print "uninitialized!  cannot finalize."
			return

		if verbose: print "added mixture %6d to the class dictionary."%self.name
		self.mode = 'finalized'
		mixture._mixtures[self.name] = self

	def print_material_card(self,comment=False):

		isotope_list_total = self.atom_fractions.keys()
		isotope_list_total.sort()

		print "c"
		print "c         %s"%self.name
		print "c"
		print "c         average amu     = %12.8f"%self.avg_amu
		print "c         density         =  %11.8f"%self.mass_density
		if len(self.mixtures_list)>0:
			print "c"
			print "c         mixture     avg. amu     atom fraction    mass fraction    volume fraction"
			print "c         --------    --------     -------------    -------------    ---------------"
			for m in self.mixtures_list:
				print "c  %15s    %8.4f     %10.8f       %10.8f       %10.8f"%(m[0].name,m[0].avg_amu,m[1],m[2],m[3])
			print "c"
			for m in self.mixtures_list:
				m[0].print_material_card(comment=True)
		print "c"
		if comment:
			for isotope in isotope_list_total:
				print "c    %6d   %8.10E"%(isotope,self.atom_fractions[isotope])
		else:
			print "c"
			print "c ISOTOPES FOR %s"%self.name
			print "c"
			print "mXXX"
			for isotope in isotope_list_total:
				print "     %6d   %8.10E"%(isotope,self.atom_fractions[isotope])
		print "c"
















##
##  material class for a mixture
##
#class material(object):
#
#	_materials = {}
#
#	def __new__(cls,name,den):
#		if not isinstance(name,str):
#			print "first input is not a string.  rejected."
#			return None
#		if not isinstance(den,float):
#			print "second input is not a float.  rejected."
#			return None
#		name = name.strip()
#		if name in material._materials.keys():
#			print "material %s already exists in the class list.  rejected."%name
#			return None
#		# else return a new instance
#		return super(material,cls).__new__(cls)
#
#	def __init__(self,name,den):
#		import copy
#		self.name 			= copy.deepcopy(name.strip())
#		self.n_elements		= 0
#		self.density 		= copy.deepcopy(den)
#		self.avg_amu 		= 0.0
#		self.mode 			= 'none'
#		self.atom_fractions	= {}
#		self.mass_fractions	= {}
#
#	def add_element_atom(self,name,frac):
#		if not isinstance(name,int):
#			if isinstance(name,str):
#				name = name.strip()
#			if name in z_number:
#				name = z_number[name]
#			else:
#				print "first input is not an int or in the element symbol dictionary.  rejected."
#				return
#		if not isinstance(frac,float):
#			print "second input is not a float.  rejected."
#			return
#		if not name in element._elements.keys():
#			print "element %d is not in the element class dictionary.  rejected."%name
#			return
#		if self.mode not in ['atom','none']:
#			print "material object is in %s mode.   delete and start over in atom mode."%self.mode
#			return
#		self.mode = 'atom'
#		self.atom_fractions[name]	= frac
#		self.n_elements				= self.n_elements + 1
#		if verbose: print "added element %6d with atom fraction %15.8f into material %s"%(name,frac,self.name)
#
#	def add_element_mass(self,name,frac):
#		if not isinstance(name,int):
#			if isinstance(name,str):
#				name = name.strip()
#			if name in z_number:
#				name = z_number[name]
#			else:
#				print "first input is not an int or in the element symbol dictionary.  rejected."
#				return
#		if not isinstance(frac,float):
#			print "second input is not a float.  rejected."
#			return
#		if not name in element._elements.keys():
#			print "element %d is not in the element class dictionary.  rejected."%name
#			return
#		if self.mode not in ['mass','none']:
#			print "material object is in %s mode.   delete and start over in mass mode."%self.mode
#			return
#		self.mode = 'mass'
#		self.mass_fractions[name]	= frac
#		self.n_elements				= self.n_elements + 1
#		if verbose: print "added element %6d with mass fraction %15.8f into material %s"%(name,frac,self.name)
#
#	def delete(self):
#		material._materials.pop(self.name, None)
#		self.__init__(self.name)
#		if verbose: print "removed material %s from the class dictionary and re-initialized all data.  the instance has not necessarily been deleted from the python namespace yet!"%self.name
#
#	def finalize(self):
#		import numpy
#		if self.mode == 'atom':
#			# sum the fractions, renormalize
#			frac_total = 0.0
#			for e in self.atom_fractions.keys():
#				frac_total = frac_total + self.atom_fractions[e]
#			for e in self.atom_fractions.keys():
#				self.atom_fractions[e] = self.atom_fractions[e] / frac_total
#			# calculate averge amu from atom fractions
#			self.avg_amu = 0.0 
#			for e in self.atom_fractions.keys():
#				self.avg_amu = self.avg_amu + self.atom_fractions[e]*element._elements[e].avg_amu
#			# calculate the mass factions
#			for e in self.atom_fractions.keys():
#				self.mass_fractions[e] = self.atom_fractions[e]*element._elements[e].avg_amu / self.avg_amu
#		elif self.mode == 'mass':
#			# sum the fractions, renormalize
#			frac_total = 0.0
#			for e in self.mass_fractions.keys():
#				frac_total = frac_total + self.mass_fractions[e]
#			for e in self.mass_fractions.keys():
#				self.mass_fractions[e] = self.mass_fractions[e] / frac_total
#			# calculate averge amu from mass fractions
#			self.avg_amu = 0.0 
#			for e in self.mass_fractions.keys():
#				self.avg_amu = self.avg_amu + self.mass_fractions[e]/element._elements[e].avg_amu
#			self.avg_amu = 1.0 / self.avg_amu
#			# calculate the atom factions
#			for e in self.mass_fractions.keys():
#				self.atom_fractions[e] = self.avg_amu * self.mass_fractions[e] / element._elements[e].avg_amu
#		elif self.mode == 'finalized':
#			print "already finalized."
#			return
#		else:
#			print "uninitialized!  cannot finalize."
#			return
#
#		if verbose: print "added material %s to the class dictionary."%self.name
#		self.mode = 'finalized'
#		material._materials[self.name] = self
#
#	def print_material_card(self):
#
#		atom_fractions_total = {}
#
#		# init
#		for e in self.atom_fractions.keys():
#				for i in element._elements[e].atom_fractions.keys():
#					atom_fractions_total[i] = 0.0
#		# set
#		for e in self.atom_fractions.keys():
#				for i in element._elements[e].atom_fractions.keys():
#					atom_fractions_total[i] = atom_fractions_total[i] + self.atom_fractions[e]*element._elements[e].atom_fractions[i][1]
#
#		isotope_list_total = atom_fractions_total.keys()
#		isotope_list_total.sort()
#
#		print "c"
#		print "c         %s"%self.name
#		print "c"
#		print "c         element     avg. amu     atom fraction    mass fraction"
#		print "c         --------    --------     -------------    -------------"
#		for e in self.atom_fractions.keys():
#			print "c  %15s    %8.4f     %10.8f       %10.8f"%(e,element._elements[e].avg_amu,self.atom_fractions[e],self.mass_fractions[e])
#		print "c"
#		print "c         average amu     = %12.8f"%self.avg_amu
#		print "c         density         =  %11.8f"%self.density
#		print "c"
#		for i in isotope_list_total:
#			print "     %6d   %8.10E"%(i,atom_fractions_total[i])
#		print "c"
#
#
#class mixture(object):
#
#	_mixture = {}
#
#	def __new__(cls,name):
#		if not isinstance(name,str):
#			print "first input is not a string.  rejected."
#			return None
#		name = name.strip()
#		if name in mixture._mixtures.keys():
#			print "mixture %s already exists in the class list.  rejected."%name
#			return None
#		# else return a new instance
#		return super(mixture,cls).__new__(cls)
#
#	def __init__(self,name):
#		import copy
#		self.name 			= copy.deepcopy(name.strip())
#		self.n_materials	= 0
#		self.avg_den 		= 0.0
#		self.avg_amu 		= 0.0
#		self.mass_total		= 0.0
#		self.mode 			= 'none'
#		self.vol_fractions	= {}
#		self.atom_fractions	= {}
#		self.mass_fractions	= {}
#
#	def add_material_vol(self,name,frac):
#		if not isinstance(name,str):
#			print "first input is not an str.  rejected."
#			return
#		name = name.strip()
#		if not isinstance(frac,float):
#			print "second input is not a float.  rejected."
#			return
#		if not name in material._materials.keys():
#			print "material %s is not in the material class dictionary.  rejected."%name
#			return
#		if self.mode not in ['volume','none']:
#			print "material object is in %s mode.   delete and start over in atom mode."%self.mode
#			return
#		self.mode = 'volume'
#		self.vol_fractions[name]	= frac
#		self.n_materials			= self.n_materials + 1
#		if verbose: print "added material %s with volume fraction %15.8f into mixture %s"%(name,frac,self.name)
#
#	def delete(self):
#		mixture._mixtures.pop(self.name, None)
#		self.__init__(self.name)
#		if verbose: print "removed mixture %s from the class dictionary and re-initialized all data.  the instance has not necessarily been deleted from the python namespace yet!"%self.name
#
#	def finalize(self):
#		import numpy
#		if self.mode == 'volume':
#			# sum the fractions, renormalize
#			frac_total = 0.0
#			for m in self.vol_fractions.keys():
#				frac_total = frac_total + self.vol_fractions[m]
#			for m in self.vol_fractions.keys():
#				self.vol_fractions[m] = self.vol_fractions[m] / frac_total
#			# calculate averge density from volume fractions
#			self.avg_den = 0.0 
#			for m in self.vol_fractions.keys():
#				self.avg_den = self.avg_den + self.vol_fractions[m]*material._materials[m].density
#			# calculate the mass factions
#			for m in self.vol_fractions.keys():
#				self.mass_fractions[m] = self.vol_fractions[m]*material._materials[m].density / self.avg_den
#			# calculate averge amu from mass fractions
#			self.avg_amu = 0.0 
#			for m in self.mass_fractions.keys():
#				self.avg_amu = self.avg_amu + self.mass_fractions[m]/material._materials[m].avg_amu
#			self.avg_amu = 1.0 / self.avg_amu
#			# calculate the atom factions
#			for m in self.mass_fractions.keys():
#				self.atom_fractions[m] = self.mass_fractions[m] * self.avg_amu / material._materials[m].avg_amu
#		elif self.mode == 'finalized':
#			print "already finalized."
#			return
#		else:
#			print "uninitialized!  cannot finalize."
#			return
#
#		if verbose: print "added mixture %s to the class dictionary."%self.name
#		self.mode = 'finalized'
#		mixture._mixtures[self.name] = self
#
#	def print_material_card(self):
#
#		atom_fractions_total = {}
#
#		# init
#		for m in self.atom_fractions.keys():
#			for e in material._materials[m].atom_fractions.keys():
#				for i in element._elements[e].atom_fractions.keys():
#					atom_fractions_total[i] = 0.0
#		# set
#		for m in self.atom_fractions.keys():
#			for e in material._materials[m].atom_fractions.keys():
#				for i in element._elements[e].atom_fractions.keys():
#					atom_fractions_total[i] = atom_fractions_total[i] + self.atom_fractions[m]*material._materials[m].atom_fractions[e]*element._elements[e].atom_fractions[i][1]
#
#		isotope_list_total = atom_fractions_total.keys()
#		isotope_list_total.sort()
#
#		print "c"
#		print "c         %s"%self.name
#		print "c"
#		print "c         material    density    avg. amu     volume fraction    atom fraction    mass fraction"
#		print "c         --------    -------    --------     ---------------    -------------    -------------"
#		for m in self.atom_fractions.keys():
#			print "c  %15s    %7.4f   %8.4f      %10.8f         %10.8f       %10.8f"%(m,material._materials[m].density,material._materials[m].avg_amu,self.vol_fractions[m],self.atom_fractions[m],self.mass_fractions[m])
#		print "c"
#		print "c         average amu     = %12.8f"%self.avg_amu
#		print "c         average density =  %11.8f"%self.avg_den
#		print "c"
#		for i in isotope_list_total:
#			print "     %6d   %8.10E"%(i,atom_fractions_total[i])
#		print "c"
#